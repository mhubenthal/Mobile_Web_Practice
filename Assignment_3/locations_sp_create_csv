-- Setup "locations" table in Postgres from "places" table.

SELECT zipcode, city, state, county, type, preferred, worldregion, country, locationtext, location INTO TABLE locations FROM places;

-- Add 'id' key as index
CREATE SEQUENCE locations_id_seq;
ALTER TABLE locations ADD id INT UNIQUE;
ALTER TABLE locations ALTER COLUMN id SET DEFAULT NEXTVAL('locations_id_seq');
UPDATE locations SET id = NEXTVAL('locations_id_seq');
ALTER TABLE locations ADD PRIMARY KEY (id);

COPY (SELECT * FROM locations) TO '/Users/maxhubenthal/Desktop/locations.csv' WITH CSV HEADER;
